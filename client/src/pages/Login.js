import React, { useState } from "react";
import { useMutation } from '@apollo/react-hooks';
import { Link } from "react-router-dom";
import { LOGIN } from "../utils/mutations"
import Nav from "../components/Nav"
import Auth from "../utils/auth";


function Login(props) {
  const [formState, setFormState] = useState({ email: '', password: '' })
  const [login, { error }] = useMutation(LOGIN);

  const handleFormSubmit = async event => {
    event.preventDefault();
    try {
      const mutationResponse = await login({ variables: { email: formState.email, password: formState.password } })
      const token = mutationResponse.data.login.token;
      Auth.login(token);
    } catch (e) {
      console.log(e)
    }
  };

  const handleChange = event => {
    const { name, value } = event.target;
    setFormState({
      ...formState,
      [name]: value
    });
  };

  return (
    <section class="login">
       <h1 className="roysters">
        <Link to="/"><img className="shellImage"src="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMV8xXyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNjQgNjQiIGhlaWdodD0iNTEyIiB2aWV3Qm94PSIwIDAgNjQgNjQiIHdpZHRoPSI1MTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTQwIDQxIDguOTMyLjg5M2MuNzEyLjA3MSAxLjQyNi4xMDcgMi4xNDEuMTA3aDUuMjk1YzEuNTQ3IDAgMi44OTUgMS4wNTMgMy4yNyAyLjU1My4yMy45MjEuMDYxIDEuODk3LS40NjUgMi42ODctLjczMyAxLjEtMS45NjYgMS43Ni0zLjI4NyAxLjc2aC0uNDU0Yy0uMjgyIDAtLjU1Ny4wODMtLjc5Mi4yNGwtMi4yOCAxLjUyYy0uMjM1LjE1Ny0uNTEuMjQtLjc5Mi4yNGgtMy41MTdjLS42ODUgMC0xLjM1NS4yMDMtMS45MjUuNTgzbC0uODQ4LjU2NmMtLjgxNC41NDItMS44MTguNzE2LTIuNzY3LjQ3OWwtMS4yNjUtLjMxNmMtLjgwNC0uMjAxLTEuNjUzLS4xMDgtMi4zOTQuMjYzbC0xLjcwMy44NTJjLS43NDEuMzctMS41OS40NjQtMi4zOTQuMjYzbC0xLjkxMy0uNDc4Yy0uNTUzLS4xMzgtMS4xMzEtLjEzOC0xLjY4MyAwbC0xLjkxMy40NzhjLS44MDQuMjAxLTEuNjUzLjEwOC0yLjM5NC0uMjYzbC0xLjcwMy0uODUyYy0uNzQxLS4zNy0xLjU5LS40NjQtMi4zOTQtLjI2M2wtMS4yNjUuMzE2Yy0uOTQ5LjIzNy0xLjk1My4wNjMtMi43NjctLjQ3OWwtLjg0OC0uNTY2Yy0uNTctLjM4LTEuMjQtLjU4My0xLjkyNS0uNTgzaC0zLjUxN2MtLjI4MiAwLS41NTctLjA4My0uNzkyLS4yNGwtMi4yODEtMS41MmMtLjIzNS0uMTU3LS41MS0uMjQtLjc5Mi0uMjRoLS43NjRjLTEuMTI3IDAtMi4xOC0uNTYzLTIuODA1LTEuNTAxbC0uMTcyLS4yNThjLS41MjctLjc5LS42OTYtMS43NjYtLjQ2NS0yLjY4Ny4zNzUtMS41MDEgMS43MjMtMi41NTQgMy4yNy0yLjU1NGg1LjI5NWMuNzE1IDAgMS40My0uMDM2IDIuMTQyLS4xMDdsOC45MzEtLjg5MyIgZmlsbD0iI2ZmZWNjNyIvPjxwYXRoIGQ9Im0zOSAzOHMwLTEgMTEtNCAxMC05IDEwLTlsLTEtNS0zLTYtMi4yMzEtMi45NzRjLS41MDEtLjY2OC0xLjE5NC0xLjE2Ny0xLjk4Ni0xLjQzMWwtLjQ0Ny0uMTQ5Yy0uODY2LS4yODktMS42MTEtLjg1OC0yLjExOC0xLjYxNy0uNzYxLTEuMTQzLTIuMDQyLTEuODI5LTMuNDE1LTEuODI5aC0uNTZjLS44MSAwLTEuNjAzLS4yNC0yLjI3Ny0uNjg5bC0uNDU1LS4zMDNjLS45NjItLjY0Mi0yLjE1MS0uODQ4LTMuMjczLS41NjhsLS45NS4yMzhjLS44MzcuMjA5LTEuNzE5LjE0OS0yLjUyLS4xNzFsLTIuMjQzLS44OTdjLS45NzktLjM5MS0yLjA3MS0uMzkxLTMuMDQ5IDBsLTIuMjQzLjg5N2MtLjgwMS4zMi0xLjY4My4zOC0yLjUyLjE3MWwtLjk1LS4yMzhjLTEuMTIyLS4yODEtMi4zMS0uMDc1LTMuMjczLjU2N2wtLjQ1NS4zMDNjLS42NzUuNDUtMS40NjcuNjktMi4yNzguNjloLS41NmMtMS4zNzMgMC0yLjY1NC42ODYtMy40MTYgMS44MjgtLjUwNi43Ni0xLjI1MSAxLjMyOS0yLjExOCAxLjYxN2wtLjQ0Ny4xNDljLS43OTIuMjY0LTEuNDg1Ljc2My0xLjk4NiAxLjQzMWwtMi4yMyAyLjk3NS0zIDYtMSA1cy0xIDYgMTAgOSAxMSA0IDExIDQiIGZpbGw9IiNmZmVjYzciLz48cGF0aCBkPSJtMjQgNDEtNC45NzUuNDk3Yy0uMDA2LjE2OS0uMDI1LjMzMy0uMDI1LjUwMyAwIDQuMTYgMS45NjEgNy44NTQgNS4wMDEgMTAuMjM0LjM5Ni4wNDcuNzg1LjE1OSAxLjE0Ny4zNGwxLjcwMy44NTJjLjc0MS4zNyAxLjU5LjQ2NCAyLjM5NC4yNjNsMS45MTMtLjQ3OGMuNTUzLS4xMzggMS4xMzEtLjEzOCAxLjY4MyAwbDEuOTEzLjQ3OGMuODA0LjIwMSAxLjY1My4xMDggMi4zOTQtLjI2M2wxLjcwMy0uODUyYy4zNjItLjE4MS43NTEtLjI5NCAxLjE0Ny0uMzQgMy4wNDEtMi4zOCA1LjAwMi02LjA3NCA1LjAwMi0xMC4yMzQgMC0uMTctLjAxOS0uMzM0LS4wMjUtLjUwM2wtNC45NzUtLjQ5N3oiIGZpbGw9IiNlZGRiYjkiLz48Y2lyY2xlIGN4PSIzMiIgY3k9IjQyIiBmaWxsPSIjZmZmIiByPSI4Ii8+PHBhdGggZD0ibTU1Ljg4NiA0OWgtLjQ1M2MtLjI4MiAwLS41NTcuMDgzLS43OTIuMjRsLTIuMjgxIDEuNTJjLS4yMzUuMTU3LS41MS4yNC0uNzkyLjI0aC0zLjUxN2MtLjY4NSAwLTEuMzU1LjIwMy0xLjkyNS41ODNsLS44NDguNTY2Yy0uODE0LjU0Mi0xLjgxOC43MTYtMi43NjcuNDc5bC0xLjI2NS0uMzE2Yy0uODA0LS4yMDEtMS42NTMtLjEwOC0yLjM5NC4yNjNsLTEuNzAzLjg1MmMtLjc0MS4zNy0xLjU5LjQ2NC0yLjM5NC4yNjNsLTEuOTEzLS40NzhjLS41NTMtLjEzOC0xLjEzMS0uMTM4LTEuNjgzIDBsLTEuOTEzLjQ3OGMtLjgwNC4yMDEtMS42NTMuMTA4LTIuMzk0LS4yNjNsLTEuNzAzLS44NTJjLS43NDEtLjM3LTEuNTktLjQ2NC0yLjM5NC0uMjYzbC0xLjI2NS4zMTZjLS45NDkuMjM3LTEuOTUzLjA2My0yLjc2Ny0uNDc5bC0uODQ4LS41NjZjLS41Ny0uMzgtMS4yNC0uNTgzLTEuOTI1LS41ODNoLTMuNTE3Yy0uMjgyIDAtLjU1Ny0uMDgzLS43OTItLjI0bC0yLjI4MS0xLjUyYy0uMjM1LS4xNTctLjUxLS4yNC0uNzkyLS4yNGgtLjc2NGMtLjgwNSAwLTEuNTY1LS4yOTctMi4xNjUtLjgwM2gtLjAxOHM5LjM3OSAxMi44MDMgMjYuMzc5IDEyLjgwMyAyNi4yNzQtMTIuODAzIDI2LjI3NC0xMi44MDNoLS4wMWMtLjY3Ny41MTEtMS41MDcuODAzLTIuMzc4LjgwM3oiIGZpbGw9IiNmZGI2MmYiLz48cGF0aCBkPSJtMzMuNDk5IDQ0LjYgMS4wMDIgMS43M2MuNzU4LS40MzggMS4zOTEtMS4wNzEgMS44MjktMS44MjlsLTEuNzMtMS4wMDJjLS4yNjQuNDU2LS42NDUuODM3LTEuMTAxIDEuMTAxeiIvPjxwYXRoIGQ9Im0zNSA0MmgyYzAtMi43NTctMi4yNDMtNS01LTV2MmMxLjY1NCAwIDMgMS4zNDYgMyAzeiIvPjxwYXRoIGQ9Im01MC4yNjMgMzQuOTY1YzExLjczNy0zLjIwMSAxMC43Ny05Ljg0OCAxMC43MTctMTAuMTYxbC0xLTVjLS4wMTgtLjA4Ny0uMDQ2LS4xNzItLjA4Ni0uMjUxbC0zLTZjLS4wMjctLjA1NC0uMDU5LS4xMDQtLjA5NS0uMTUybC0yLjIyOS0yLjk3NGMtLjYyNi0uODM1LTEuNDgtMS40NTEtMi40NzEtMS43OGwtLjQ0Ny0uMTQ5Yy0uNjUyLS4yMTktMS4yMjEtLjY1My0xLjYwMS0xLjIyNS0uOTQ5LTEuNDIzLTIuNTM3LTIuMjczLTQuMjQ4LTIuMjczaC0uNTZjLS42MTQgMC0xLjIxLS4xODEtMS43MjQtLjUyMmwtLjQ1NC0uMzAyYy0xLjE5MS0uNzk1LTIuNjc3LTEuMDU2LTQuMDY5LS43MDVsLS45NTEuMjM3Yy0uNjQuMTU5LTEuMjk3LjExNC0xLjkwNi0uMTNsLTIuMjQzLS44OTdjLTEuMjIyLS40ODctMi41NjctLjQ4OS0zLjc5MSAwbC0yLjI0My44OTdjLS42MTEuMjQ1LTEuMjcxLjI4OS0xLjkwNy4xM2wtLjk1LS4yMzdjLTEuMzkxLS4zNTItMi44NzYtLjA5MS00LjA2OC43MDRsLS40NTcuMzA0Yy0uNTEzLjM0LTEuMTA5LjUyMS0xLjcyMy41MjFoLS41NmMtMS43MTEgMC0zLjI5OS44NS00LjI0OCAyLjI3My0uMzguNTcyLS45NDkgMS4wMDYtMS42MDEgMS4yMjRsLS40NDYuMTQ4Yy0uOTkxLjMzLTEuODQ2Ljk0Ni0yLjQ3MSAxLjc4MWwtMi4yMzEgMi45NzRjLS4wMzYuMDQ4LS4wNjcuMDk5LS4wOTUuMTUybC0zIDZjLS4wNC4wNzktLjA2OC4xNjQtLjA4Ni4yNTFsLTEuMDA2IDUuMDMyYy0uMDQ2LjI4Mi0xLjAxMyA2LjkyOSAxMC43MjQgMTAuMTMgNi43OTcgMS44NTMgOS4yMjIgMi45IDEwLjA1OSAzLjM1My0uMjUyLjU1OC0uNDUgMS4xNDUtLjU4NCAxLjc1NmwtOC4yNDMuODI1Yy0uNjgyLjA2Ny0xLjM2OS4xMDEtMi4wNDIuMTAxaC01LjI5NWMtMi4wMDkgMC0zLjc1MiAxLjM2MS00LjI0IDMuMzExLS4yOTggMS4xOS0uMDc4IDIuNDYxLjYwNCAzLjQ4NWwuMTcyLjI1OGMuMjA3LjMxLjQ1LjU4Ny43Mi44My45NjkgMS4yODIgMTAuMzg1IDEzLjExNiAyNy4xMTIgMTMuMTE2IDE2Ljc0NCAwIDI2LjA2OC0xMS44NTkgMjcuMDE0LTEzLjEyNC4zNzYtLjMwNy43MTQtLjY2NS45OTEtMS4wODEuNjgxLTEuMDIzLjktMi4yOTQuNjAzLTMuNDg0LS40ODgtMS45NS0yLjIzMS0zLjMxMS00LjI0LTMuMzExaC01LjI5NWMtLjY3MyAwLTEuMzYtLjAzNC0yLjA0Mi0uMTAybC04LjI0NC0uODI1Yy0uMTM0LS42MTEtLjMzMi0xLjE5OC0uNTg0LTEuNzU2LjgzOC0uNDUzIDMuMjYzLTEuNDk5IDEwLjA2LTMuMzUyem0tMTguMjYzLjAzNWMzLjg1OSAwIDcgMy4xNDEgNyA3cy0zLjE0MSA3LTcgNy03LTMuMTQxLTctNyAzLjE0MS03IDctN3ptLTE3LjczNy0xLjk2NWMtOS44ODEtMi42OTUtOS4zMDQtNy42NzMtOS4yODItNy44MzlsLjk3NC00Ljg2OSAyLjktNS43OTkgMi4xNzctMi45MDJjLjM4LS41MDguODk5LS44ODIgMS41MDItMS4wODNsLjQ0Ny0uMTQ5YzEuMDcyLS4zNTcgMi4wMDgtMS4wNzIgMi42MzMtMi4wMTEuNTc2LS44NjYgMS41NDItMS4zODMgMi41ODMtMS4zODNoLjU2YzEuMDEgMCAxLjk4OS0uMjk2IDIuODMxLS44NTZsLjQ1Ni0uMzA0Yy43MjYtLjQ4MyAxLjYzLS42NCAyLjQ3Ni0uNDNsLjk0OS4yMzdjMS4wNDcuMjY0IDIuMTMyLjE4OCAzLjEzNS0uMjEybDIuMjQzLS44OTdjLjc0NC0uMjk3IDEuNTYzLS4yOTcgMi4zMDcgMGwyLjI0My44OTdjMS4wMDMuNDAyIDIuMDg5LjQ3NiAzLjEzNC4yMTJsLjk1LS4yMzdjLjg0NS0uMjEyIDEuNzQ5LS4wNTUgMi40NzcuNDMxbC40NTUuMzAyYy44NDEuNTYxIDEuODIuODU3IDIuODMuODU3aC41NmMxLjA0MSAwIDIuMDA3LjUxNyAyLjU4NCAxLjM4My42MjUuOTM4IDEuNTYxIDEuNjUzIDIuNjMzIDIuMDExbC40NDguMTVjLjYwMi4yIDEuMTIxLjU3NCAxLjUwMiAxLjA4MmwyLjE3NiAyLjkwMiAyLjkgNS43OTkuOTY2IDQuODI0Yy4wMjkuMjExLjYwNiA1LjE4OC05LjI3NCA3Ljg4NC02LjI3MSAxLjcxLTkuMTkgMi44MS0xMC41NSAzLjU3LTEuNjQ1LTIuMTg0LTQuMjUtMy42MDUtNy4xODgtMy42MDVzLTUuNTQzIDEuNDIxLTcuMTg3IDMuNjA1Yy0xLjM2LS43Ni00LjI3OS0xLjg1OS0xMC41NS0zLjU3em0xNy43MzcgMjYuOTY1Yy0xMS43NDMgMC0xOS44MDgtNi4zOTMtMjMuNDIyLTkuOTk3LjA4MS4wMDIuMTU5LjAyMy4yMjcuMDY4bDIuMjgxIDEuNTIxYy4zOTkuMjY3Ljg2NS40MDggMS4zNDYuNDA4aDMuNTE4Yy40ODkgMCAuOTYzLjE0NCAxLjM3LjQxNWwuODQ5LjU2NWMxLjA0Ny42OTYgMi4zNDYuOTI0IDMuNTYzLjYxN2wxLjI2Ny0uMzE2Yy41NjktLjE0MyAxLjE3Ni0uMDc2IDEuNzAzLjE4OGwxLjcwNC44NTJjLjYyNS4zMTMgMS4zMTEuNDcyIDEuOTk5LjQ3Mi4zNjMgMCAuNzI4LS4wNDQgMS4wODMtLjEzNGwxLjkxMy0uNDc4Yy4zOTUtLjA5OC44MDktLjA5OCAxLjE5OS0uMDAxbDEuOTEyLjQ3OWMxLjAzNS4yNjEgMi4xMjkuMTQgMy4wODQtLjMzOGwxLjcwMi0uODUyYy41MjgtLjI2NCAxLjEzMS0uMzMgMS43MDUtLjE4OGwxLjI2NS4zMTZjMS4yMi4zMDcgMi41MTguMDc5IDMuNTY0LS42MTdsLjg0OS0uNTY1Yy40MDctLjI3MS44ODEtLjQxNSAxLjM3LS40MTVoMy41MThjLjQ4IDAgLjk0Ni0uMTQxIDEuMzQ2LS40MDdsMi4yODEtMS41MjFjLjAzMS0uMDIxLjA3LS4wMi4xMDUtLjAzMi0zLjYgMy42MDgtMTEuNTk5IDkuOTYtMjMuMzAxIDkuOTZ6bTE5LjA3My0xN2g1LjI5NWMxLjA5IDAgMi4wMzUuNzM5IDIuMzAxIDEuNzk3LjE2MS42NDUuMDQyIDEuMzM0LS4zMjggMS44OS0uNTQ4LjgyMi0xLjQ2NiAxLjMxMy0yLjQ1NSAxLjMxM2gtLjQ1NGMtLjQ4IDAtLjk0Ni4xNDEtMS4zNDYuNDA3bC0yLjI4MSAxLjUyMWMtLjA3MS4wNDgtLjE1Mi4wNzItLjIzNy4wNzJoLTMuNTE4Yy0uODg2IDAtMS43NDMuMjYtMi40NzkuNzUxbC0uODQ5LjU2NWMtLjU3OS4zODYtMS4yOTUuNTEtMS45Ny4zNDJsLTEuMjY1LS4zMTZjLTEuMDM0LS4yNjEtMi4xMjktLjEzOS0zLjA4NC4zMzhsLTEuNzAyLjg1MmMtLjUyOS4yNjQtMS4xMzMuMzI4LTEuNzA1LjE4OGwtMS45MTMtLjQ3OWMtLjcwOC0uMTc2LTEuNDU4LS4xNzctMi4xNjguMDAxbC0xLjkxNC40NzljLS41NzEuMTQxLTEuMTc2LjA3Ni0xLjcwMy0uMTg4bC0xLjcwNC0uODUyYy0uOTU1LS40NzgtMi4wNS0uNTk5LTMuMDgyLS4zMzhsLTEuMjY3LjMxNmMtLjY3LjE2OC0xLjM5LjA0NC0xLjk2OS0uMzQybC0uODQ5LS41NjVjLS43MzUtLjQ5Mi0xLjU5Mi0uNzUyLTIuNDc4LS43NTJoLTMuNTE4Yy0uMDg1IDAtLjE2Ni0uMDI0LS4yMzYtLjA3MWwtMi4yODEtMS41MjFjLS4zOTktLjI2Ny0uODY1LS40MDgtMS4zNDYtLjQwOGgtLjc2NGMtLjc5NSAwLTEuNTMyLS4zOTUtMS45NzMtMS4wNTZsLS4xNzEtLjI1NmMtLjM3MS0uNTU3LS40OS0xLjI0Ni0uMzI5LTEuODkxLjI2Ni0xLjA1OCAxLjIxMS0xLjc5NyAyLjMwMS0xLjc5N2g1LjI5NWMuNzM4IDAgMS40OTItLjAzNyAyLjI0MS0uMTExbDcuODM3LS43ODRjLjA1NyA0LjkxNCA0LjA2NyA4Ljg5NSA4Ljk5NSA4Ljg5NXM4LjkzOC0zLjk4MSA4Ljk5NS04Ljg5NWw3LjgzOC43ODRjLjc0OC4wNzQgMS41MDIuMTExIDIuMjQuMTExeiIvPjxwYXRoIGQ9Im0zMSAxMmgydjE3aC0yeiIvPjxwYXRoIGQ9Im0yMy4yMTEgMTUuNzY1aDJ2MTUuNTk4aC0yeiIgdHJhbnNmb3JtPSJtYXRyaXgoLjg0MiAtLjU0IC41NCAuODQyIC04Ljg5MSAxNi44MDYpIi8+PHBhdGggZD0ibTE4LjEzMSAyMy4wODRoMnYxMy41MTZoLTJ6IiB0cmFuc2Zvcm09Im1hdHJpeCguNDIxIC0uOTA3IC45MDcgLjQyMSAtMTUuOTkxIDM0LjYzOCkiLz48cGF0aCBkPSJtMzEuOTkgMjIuNTY0aDE1LjU5OHYyaC0xNS41OTh6IiB0cmFuc2Zvcm09Im1hdHJpeCguNTQgLS44NDIgLjg0MiAuNTQgLTEuNTI5IDQ0LjMzKSIvPjxwYXRoIGQ9Im0zOC4xMTEgMjguODQyaDEzLjUxNnYyaC0xMy41MTZ6IiB0cmFuc2Zvcm09Im1hdHJpeCguOTA3IC0uNDIxIC40MjEgLjkwNyAtOC4zOSAyMS42MzgpIi8+PC9zdmc+" /></Link>

      </h1>
      <div className="loginForm col-3">
        <Link to="/signup">
          ← Go to Signup
      </Link>

        <h2>Login</h2>
        <form onSubmit={handleFormSubmit}>
          <div className="space-between my-2">
            <label htmlFor="email"></label>
            <input
              placeholder="Email Address"
              name="email"
              type="email"
              id="email"
              onChange={handleChange}
            />
          </div>
          <div className="space-between my-2">
            <label htmlFor="pwd"></label>
            <input
              placeholder="Password"
              name="password"
              type="password"
              id="pwd"
              onChange={handleChange}
            />
          </div>
          {
            error ? <div>
              <p className="error-text" >The provided credentials are incorrect</p>
            </div> : null
          }
          <div className="flex-end">
            <button class="loginSubmitBtn" type="submit">
              Submit
          </button>
          </div>
        </form>
      </div>
    </section>
  );
}


export default Login;
